"use strict";(self.webpackChunkhackernews=self.webpackChunkhackernews||[]).push([[228],{1228:(M,S,i)=>{i.r(S),i.d(S,{TopStoriesComponent:()=>D});var d=i(5093),T=i(4599),g=i(1676),p=i(7292),L=i(9927),v=i(808),h=i(4318),C=i(2177),Z=i(6173),x=i(812),$=i(8366),I=i(3756),A=i(2799),U=i(909);function J(...o){const r=(0,U.jO)(o);return(0,Z.e)((e,s)=>{const n=o.length,a=new Array(n);let c=o.map(()=>!1),f=!1;for(let l=0;l<n;l++)(0,$.Xf)(o[l]).subscribe((0,x.x)(s,u=>{a[l]=u,!f&&!c[l]&&(c[l]=!0,(f=c.every(I.y))&&(c=null))},A.Z));e.subscribe((0,x.x)(s,l=>{if(f){const u=[l,...a];s.next(r?r(...u):u)}}))})}var N=i(4273),m=i(1292),t=i(2509);let Y=(()=>{class o{transform(e,...s){try{return new URL(e).hostname}catch{return""}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275pipe=t.Yjl({name:"urlPreview",type:o,pure:!0,standalone:!0}),o})();var Q=i(6038);let j=(()=>{class o{constructor(){this.localStorageKey="saved-stories",this.savedStoriesCache$=new p.X([]),this.savedStoriesCache$.next(this.loadSavedStoriesFromLocalStorage())}saveStory(e){const s=this.savedStoriesCache$.value;s.push(e.id),this.saveStoriesToLocalStorage(s)}unSaveStory(e){this.saveStoriesToLocalStorage(this.savedStoriesCache$.value.filter(n=>n!==e.id))}getSavedStories$(){return this.savedStoriesCache$.pipe()}loadSavedStoriesFromLocalStorage(){let e=[];const s=localStorage.getItem(this.localStorageKey);return s&&(e=JSON.parse(s)),this.savedStoriesCache$.next(e),e}saveStoriesToLocalStorage(e){this.savedStoriesCache$.next(e),localStorage.setItem(this.localStorageKey,JSON.stringify(e))}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function w(o,r){if(1&o&&(t.TgZ(0,"span",4),t._uU(1),t.qZA()),2&o){const e=r.ngIf;t.xp6(1),t.hij("(",0===e?"loading...":e,")")}}function F(o,r){1&o&&(t.TgZ(0,"p",5),t._uU(1," Loading stories...\n"),t.qZA())}function P(o,r){1&o&&(t.TgZ(0,"p",5),t._uU(1," Loading stories info...\n"),t.qZA())}function O(o,r){if(1&o&&(t.TgZ(0,"a",15),t._uU(1),t.TgZ(2,"span",16),t._uU(3),t.ALo(4,"urlPreview"),t.qZA()()),2&o){const e=t.oxw().$implicit;t.Q6J("href",e.url,t.LSH),t.xp6(1),t.hij(" ",e.title," "),t.xp6(2),t.Oqu(t.lcZ(4,3,e.url))}}const y=function(o){return["/stories",o]};function K(o,r){if(1&o&&(t.TgZ(0,"a",17),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(2,y,e.id)),t.xp6(1),t.hij(" ",e.title," ")}}function X(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"span",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.savedStories.unSaveStory(n))}),t._uU(1," Unsave story. "),t.qZA()}}function V(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"span",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.savedStories.saveStory(n))}),t._uU(1," Save story. "),t.qZA()}}const z=function(o){return["/user",o]};function E(o,r){if(1&o&&(t.TgZ(0,"div",8),t.YNc(1,O,5,5,"a",9),t.YNc(2,K,2,4,"a",10),t.TgZ(3,"div",11)(4,"p",12),t._uU(5),t.ALo(6,"date"),t.TgZ(7,"a",13),t._uU(8),t.qZA()(),t.TgZ(9,"div")(10,"a",13),t._uU(11),t.qZA(),t.YNc(12,X,2,0,"span",14),t.YNc(13,V,2,0,"span",14),t.qZA()()()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.url),t.xp6(1),t.Q6J("ngIf",!e.url),t.xp6(3),t.AsE(" ",e.score," point posted at ",t.xi3(6,10,1e3*e.time,"medium")," by "),t.xp6(2),t.Q6J("routerLink",t.VKq(13,z,e.by)),t.xp6(1),t.Oqu(e.by),t.xp6(2),t.Q6J("routerLink",t.VKq(15,y,e.id)),t.xp6(1),t.hij(" ",e.descendants," comments. "),t.xp6(1),t.Q6J("ngIf",!0===e.saved),t.xp6(1),t.Q6J("ngIf",!1===e.saved)}}function H(o,r){if(1&o&&(t.TgZ(0,"section",6),t.YNc(1,E,14,17,"div",7),t.qZA()),2&o){const e=r.ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}let D=(()=>{class o{set storiesPageType(e){this.triggerStoriesLoad.next(e)}constructor(e,s){this.hnService=e,this.savedStories=s,this.triggerStoriesLoad=new T.t,this.pageTitle$=this.triggerStoriesLoad.pipe((0,g.U)(n=>"saved-stories"===n?"You saved stories":"Top stories")),this.firstStoryIndex$=new p.X(0),this.lastStoryIndex$=new p.X(50),this.storiesCount$=new p.X(0),this.storiesLoading=new p.X(!0),this.storiesContentLoading=new p.X(!1),this.stories$=(0,L.a)([this.triggerStoriesLoad.pipe((0,v.b)(()=>{this.storiesContentLoading.next(!0)}),(0,h.b)(n=>{switch(n){case"saved-stories":return this.savedStories.getSavedStories$();case"top-stories":return this.hnService.fetchTopStories();default:return console.log("Error. No StoriesPageType"),(0,C.of)([])}}),(0,v.b)(n=>{this.storiesLoading.next(!1),this.storiesCount$.next(n.length)}),J(this.firstStoryIndex$,this.lastStoryIndex$),(0,h.b)(([n,a,c])=>(0,N.D)(n.slice(a,c).map(f=>this.hnService.fetchStory(f)))),(0,g.U)(n=>n.filter(a=>["story"].includes(a.type))),(0,v.b)(()=>{this.storiesLoading.next(!1),this.storiesContentLoading.next(!1)})),this.savedStories.getSavedStories$()]).pipe((0,g.U)(([n,a])=>n.map(c=>({...c,saved:a.includes(c.id)}))))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Q.c),t.Y36(j))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-top-stories"]],inputs:{storiesPageType:"storiesPageType"},standalone:!0,features:[t.jDz],decls:11,vars:15,consts:[[1,"text-xl"],["class","text-gray-600",4,"ngIf"],["class","text-gray-700",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"text-gray-600"],[1,"text-gray-700"],[1,"flex","flex-col"],["class","mx-2 my-2",4,"ngFor","ngForOf"],[1,"mx-2","my-2"],["class","text-lg font-semibold transition-colors hover:text-orange-600",3,"href",4,"ngIf"],["class","text-lg font-semibold transition-colors hover:text-orange-600",3,"routerLink",4,"ngIf"],[1,"text-sm","text-gray-600"],[1,""],[1,"hover:underline","underline-offset-2","decoration-orange-600",3,"routerLink"],["class","cursor-pointer hover:underline underline-offset-2 decoration-orange-600",3,"click",4,"ngIf"],[1,"text-lg","font-semibold","transition-colors","hover:text-orange-600",3,"href"],[1,"text-xs","text-gray-500"],[1,"text-lg","font-semibold","transition-colors","hover:text-orange-600",3,"routerLink"],[1,"cursor-pointer","hover:underline","underline-offset-2","decoration-orange-600",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"p",0),t._uU(1),t.ALo(2,"async"),t.YNc(3,w,2,1,"span",1),t.ALo(4,"async"),t.qZA(),t.YNc(5,F,2,0,"p",2),t.ALo(6,"async"),t.YNc(7,P,2,0,"p",2),t.ALo(8,"async"),t.YNc(9,H,2,1,"section",3),t.ALo(10,"async")),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,5,s.pageTitle$)," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(4,7,s.storiesCount$)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(6,9,s.storiesLoading)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(8,11,s.storiesContentLoading)),t.xp6(2),t.Q6J("ngIf",t.lcZ(10,13,s.stories$)))},dependencies:[d.ez,d.sg,d.O5,d.Ov,d.uU,m.Bz,m.rH,Y],changeDetection:0}),o})()}}]);