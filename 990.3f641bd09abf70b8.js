"use strict";(self.webpackChunkhackernews=self.webpackChunkhackernews||[]).push([[990],{8990:(R,v,s)=>{s.r(v),s.d(v,{ViewPostComponent:()=>K});var m=s(5093),y=s(4599),f=s(4318),u=s(808),w=s(8730),p=s(7292),J=s(2820),A=s(7371),V=s(8366),$=s(909),Q=s(812),I=s(4843),O=s(427);function L(...n){const i=(0,$.jO)(n),{args:e,keys:o}=(0,A.D)(n),r=new J.y(c=>{const{length:l}=e;if(!l)return void c.complete();const d=new Array(l);let Z=l,T=l;for(let x=0;x<l;x++){let C=!1;(0,V.Xf)(e[x]).subscribe((0,Q.x)(c,E=>{C||(C=!0,T--),d[x]=E},()=>Z--,void 0,()=>{(!Z||!C)&&(T||c.next(o?(0,O.n)(o,d):d),c.complete())}))}});return i?r.pipe((0,I.Z)(i)):r}var P=s(2177),g=s(7717),_=s(6486),a=s(2285),t=s(4023),h=s(3779),b=s(6038);function U(n,i){if(1&n&&t._UZ(0,"p",8),2&n){const e=t.oxw().ngrxLet,o=t.oxw();t.Q6J("innerHTML",o.sanitizer.bypassSecurityTrustHtml(e.text),t.oJD)}}function k(n,i){if(1&n&&t._UZ(0,"app-comment",12),2&n){const e=i.$implicit,o=t.oxw(4);t.Udp("margin-left",1*(o.hierarchyLevel+1),"rem"),t.Q6J("comment",e)("hierarchyLevel",o.hierarchyLevel+1)}}function Y(n,i){if(1&n&&(t.TgZ(0,"section",10),t.YNc(1,k,1,4,"app-comment",11),t.qZA()),2&n){const e=i.ngrxLet;t.xp6(1),t.Q6J("ngForOf",e)}}function N(n,i){if(1&n&&(t.ynx(0),t.YNc(1,Y,2,1,"section",9),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngrxLet",e.subComments$)}}function j(n,i){1&n&&(t.TgZ(0,"section")(1,"p",13),t._uU(2,"Loading sub comments..."),t.qZA()())}const F=function(n){return["/user",n]};function H(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"section",1)(2,"div",2),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.toggleCommentVisibility.next(!r.toggleCommentVisibility.value))}),t.qZA(),t.TgZ(3,"div",3)(4,"p",4)(5,"a",5),t._uU(6),t.qZA(),t._uU(7),t.ALo(8,"date"),t.qZA(),t.YNc(9,U,1,1,"p",6),t.ALo(10,"ngrxPush"),t.qZA()(),t.YNc(11,N,2,1,"ng-container",7),t.ALo(12,"ngrxPush"),t.YNc(13,j,3,0,"section",7),t.ALo(14,"ngrxPush"),t.BQk()}if(2&n){const e=i.ngrxLet,o=t.oxw();t.xp6(5),t.Q6J("routerLink",t.VKq(15,F,e.by)),t.xp6(1),t.hij(" ",e.by,""),t.xp6(1),t.hij(" at ",t.xi3(8,6,1e3*e.time,"medium")," "),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(10,9,o.toggleCommentVisibility)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(12,11,o.toggleCommentVisibility)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(14,13,o.subCommentLoading$))}}let z=(()=>{class n{set comment(e){this.comment$.next(e)}constructor(e,o){this.sanitizer=e,this.hn=o,this.hierarchyLevel=0,this.subCommentLoading$=new p.X(!1),this.comment$=new y.t,this.subComments$=this.comment$.pipe((0,_.h)(r=>!!r&&!!r.kids&&r.kids.length>0),(0,u.b)(()=>{this.subCommentLoading$.next(!0)}),(0,f.b)(r=>L(r.kids.map(c=>this.hn.fetchComment(c)))),(0,u.b)(()=>{this.subCommentLoading$.next(!1)})),this.toggleCommentVisibility=new p.X(!0)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.H7),t.Y36(b.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comment"]],inputs:{comment:"comment",hierarchyLevel:"hierarchyLevel"},standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[[4,"ngrxLet"],[1,"flex","flex-row","space-x-1"],[1,"w-2","bg-orange-300","cursor-pointer","hover:bg-orange-400",3,"click"],[1,"flex-1"],[1,"text-sm","text-gray-400"],[1,"hover:underline","underline-offset-2","decoration-orange-600","hover:text-gray-600",3,"routerLink"],["class","w-auto ml-2 prose-sm prose prose-gray max-w-none",3,"innerHTML",4,"ngIf"],[4,"ngIf"],[1,"w-auto","ml-2","prose-sm","prose","prose-gray","max-w-none",3,"innerHTML"],["class","flex flex-col space-y-4",4,"ngrxLet"],[1,"flex","flex-col","space-y-4"],["class","block mt-2",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block","mt-2",3,"comment","hierarchyLevel"],[1,"text-gray-600"]],template:function(e,o){1&e&&t.YNc(0,H,15,17,"ng-container",0),2&e&&t.Q6J("ngrxLet",o.comment$)},dependencies:[n,m.ez,m.sg,m.O5,m.uU,g.Bz,g.rH,a._N,a.eJ,a.pP,a.fM],changeDetection:0}),n})();function M(n,i){if(1&n&&t._UZ(0,"iframe",10),2&n){const e=t.oxw().ngrxLet,o=t.oxw();t.Q6J("src",o.sanitizer.bypassSecurityTrustResourceUrl(e.url),t.uOi)}}const D=function(n){return["/user",n]};function S(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"h1",3),t._uU(2),t.qZA(),t.TgZ(3,"p",4),t._uU(4),t.ALo(5,"date"),t.TgZ(6,"a",5),t._uU(7),t.qZA()(),t.TgZ(8,"section",6)(9,"button",7),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.linkIframeVisible.next(!r.linkIframeVisible.value))}),t._uU(10," Open post with comments "),t.qZA(),t.TgZ(11,"a",8),t._uU(12," Open post in new tab "),t.qZA()(),t.YNc(13,M,1,1,"iframe",9),t.ALo(14,"ngrxPush"),t.BQk()}if(2&n){const e=i.ngrxLet,o=t.oxw();t.xp6(2),t.Oqu(e.title),t.xp6(2),t.hij(" ",t.xi3(5,6,1e3*e.time,"medium")," by "),t.xp6(2),t.Q6J("routerLink",t.VKq(11,D,e.by)),t.xp6(1),t.hij(" ",e.by,""),t.xp6(4),t.Q6J("href",e.url,t.LSH),t.xp6(2),t.Q6J("ngIf",e.url&&!0===t.lcZ(14,9,o.linkIframeVisible))}}function X(n,i){if(1&n&&t._UZ(0,"app-comment",13),2&n){const e=i.$implicit;t.Udp("margin-left",1,"rem"),t.Q6J("comment",e)("hierarchyLevel",1)}}function B(n,i){if(1&n&&(t.TgZ(0,"section",11),t.YNc(1,X,1,4,"app-comment",12),t.qZA()),2&n){const e=i.ngrxLet;t.xp6(1),t.Q6J("ngForOf",e)}}let K=(()=>{class n{set postId(e){this.postIdChanged$.next(e)}constructor(e,o,r){this.hn=e,this.sanitizer=o,this.title=r,this.postIdChanged$=new y.t,this.post$=this.postIdChanged$.pipe((0,f.b)(c=>this.hn.fetchPost(c)),(0,u.b)(c=>{this.title.setTitle(`Post: ${c.title}`)}),(0,w.d)()),this.commentsLoading$=new p.X(!1),this.comments$=this.post$.pipe((0,f.b)(c=>c.kids&&c.kids.length>0?L(c.kids.map(l=>this.hn.fetchComment(l))):(0,P.of)([]))),this.linkIframeVisible=new p.X(!1)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.c),t.Y36(h.H7),t.Y36(h.Dx))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-view-post"]],inputs:{postId:"postId"},standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[[1,""],[4,"ngrxLet"],["class","flex flex-col space-y-4",4,"ngrxLet"],[1,"text-lg"],[1,"text-sm","text-gray-600"],[1,"hover:underline","underline-offset-2","decoration-orange-600",3,"routerLink"],[1,"flex","flex-row","my-2","space-x-5"],[1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"click"],["target","_blank",1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"href"],["class","h-[80vh] mx-auto w-[100%]","frameborder","0",3,"src",4,"ngIf"],["frameborder","0",1,"h-[80vh]","mx-auto","w-[100%]",3,"src"],[1,"flex","flex-col","space-y-4"],["class","block",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block",3,"comment","hierarchyLevel"]],template:function(e,o){1&e&&(t.TgZ(0,"section",0),t.YNc(1,S,15,13,"ng-container",1),t.YNc(2,B,2,1,"section",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngrxLet",o.post$),t.xp6(1),t.Q6J("ngrxLet",o.comments$))},dependencies:[m.ez,m.sg,m.O5,m.uU,g.Bz,g.rH,z,a._N,a.eJ,a.pP,a.fM],changeDetection:0}),n})()}}]);