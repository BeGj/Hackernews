"use strict";(self.webpackChunkhackernews=self.webpackChunkhackernews||[]).push([[553],{6553:(U,h,c)=>{c.r(h),c.d(h,{StoryViewComponent:()=>Q});var s=c(5093),u=c(4599),p=c(4318),g=c(808),d=c(8730),a=c(7292),x=c(4273),l=c(2523),C=c(6486),t=c(2509),f=c(3779),y=c(6038);function _(e,i){if(1&e&&t._UZ(0,"p",7),2&e){const n=t.oxw().ngIf,o=t.oxw();t.Q6J("innerHTML",o.sanitizer.bypassSecurityTrustHtml(n.text),t.oJD)}}function v(e,i){if(1&e&&t._UZ(0,"app-comment",11),2&e){const n=i.$implicit,o=t.oxw(4);t.Udp("margin-left",2*(o.hierarchyLevel+1),"rem"),t.Q6J("comment",n)("hierarchyLevel",o.hierarchyLevel+1)}}function b(e,i){if(1&e&&(t.TgZ(0,"section",9),t.YNc(1,v,1,4,"app-comment",10),t.qZA()),2&e){const n=i.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}function L(e,i){if(1&e&&(t.ynx(0),t.YNc(1,b,2,1,"section",8),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.subComments$))}}function Z(e,i){1&e&&(t.TgZ(0,"section")(1,"p",12),t._uU(2,"Loading subcomments..."),t.qZA()())}const w=function(e){return["/user",e]};function T(e,i){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"section",1)(2,"div",2),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.toggleCommentVisibility.next(!r.toggleCommentVisibility.value))}),t.qZA(),t.TgZ(3,"div",3)(4,"p",4)(5,"a",5),t._uU(6),t.qZA(),t._uU(7),t.ALo(8,"date"),t.qZA(),t.YNc(9,_,1,1,"p",6),t.ALo(10,"async"),t.qZA()(),t.YNc(11,L,3,3,"ng-container",0),t.ALo(12,"async"),t.YNc(13,Z,3,0,"section",0),t.ALo(14,"async"),t.BQk()}if(2&e){const n=i.ngIf,o=t.oxw();t.xp6(5),t.Q6J("routerLink",t.VKq(15,w,n.by)),t.xp6(1),t.hij(" ",n.by,""),t.xp6(1),t.hij(" at ",t.xi3(8,6,1e3*n.time,"medium")," "),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(10,9,o.toggleCommentVisibility)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(12,11,o.toggleCommentVisibility)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(14,13,o.subCommentLoading$))}}let I=(()=>{class e{set comment(n){this.comment$.next(n)}constructor(n,o){this.sanitizer=n,this.hn=o,this.hierarchyLevel=0,this.subCommentLoading$=new a.X(!1),this.comment$=new u.t,this.subComments$=this.comment$.pipe((0,C.h)(r=>!!r&&!!r.kids&&r.kids.length>0),(0,g.b)(()=>{this.subCommentLoading$.next(!0)}),(0,p.b)(r=>(0,x.D)(r.kids.map(m=>this.hn.fetchComment(m)))),(0,g.b)(()=>{this.subCommentLoading$.next(!1)})),this.toggleCommentVisibility=new a.X(!0)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.H7),t.Y36(y.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-comment"]],inputs:{comment:"comment",hierarchyLevel:"hierarchyLevel"},standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"flex","flex-row","space-x-1"],[1,"w-2","bg-orange-300","cursor-pointer","hover:bg-orange-400",3,"click"],[1,"flex-1"],[1,"text-sm","text-gray-400"],[1,"hover:underline","underline-offset-2","decoration-orange-600","hover:text-gray-600",3,"routerLink"],["class","w-auto ml-2 prose-sm prose prose-gray max-w-none",3,"innerHTML",4,"ngIf"],[1,"w-auto","ml-2","prose-sm","prose","prose-gray","max-w-none",3,"innerHTML"],["class","flex flex-col space-y-4",4,"ngIf"],[1,"flex","flex-col","space-y-4"],["class","block mt-2",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block","mt-2",3,"comment","hierarchyLevel"],[1,"text-gray-600"]],template:function(n,o){1&n&&(t.YNc(0,T,15,17,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.comment$))},dependencies:[e,s.ez,s.sg,s.O5,s.Ov,s.uU,l.Bz,l.rH],changeDetection:0}),e})();function A(e,i){if(1&e&&t._UZ(0,"iframe",10),2&e){const n=t.oxw().ngIf,o=t.oxw();t.Q6J("src",o.sanitizer.bypassSecurityTrustResourceUrl(n.url),t.uOi)}}const $=function(e){return["/user",e]};function k(e,i){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"h1",3),t._uU(2),t.qZA(),t.TgZ(3,"p",4),t._uU(4),t.ALo(5,"date"),t.TgZ(6,"a",5),t._uU(7),t.qZA()(),t.TgZ(8,"section",6)(9,"button",7),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.linkIframeVisible.next(!r.linkIframeVisible.value))}),t._uU(10," Open story with comments "),t.qZA(),t.TgZ(11,"a",8),t._uU(12," Open story in new tab "),t.qZA()(),t.YNc(13,A,1,1,"iframe",9),t.ALo(14,"async"),t.BQk()}if(2&e){const n=i.ngIf,o=t.oxw();t.xp6(2),t.Oqu(n.title),t.xp6(2),t.hij(" ",t.xi3(5,6,1e3*n.time,"medium")," by "),t.xp6(2),t.Q6J("routerLink",t.VKq(11,$,n.by)),t.xp6(1),t.hij(" ",n.by,""),t.xp6(4),t.Q6J("href",n.url,t.LSH),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(14,9,o.linkIframeVisible))}}function J(e,i){if(1&e&&t._UZ(0,"app-comment",13),2&e){const n=i.$implicit;t.Udp("margin-left",1,"rem"),t.Q6J("comment",n)("hierarchyLevel",1)}}function V(e,i){if(1&e&&(t.TgZ(0,"section",11),t.YNc(1,J,1,4,"app-comment",12),t.qZA()),2&e){const n=i.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}let Q=(()=>{class e{set storyId(n){this.storyIdChanged$.next(n)}constructor(n,o,r){this.hn=n,this.sanitizer=o,this.title=r,this.storyIdChanged$=new u.t,this.story$=this.storyIdChanged$.pipe((0,p.b)(m=>this.hn.fetchStory(m)),(0,g.b)(m=>{this.title.setTitle(`Story: ${m.title}`)}),(0,d.d)()),this.commentsLoading$=new a.X(!1),this.comments$=this.story$.pipe((0,p.b)(m=>(0,x.D)(m.kids.map(S=>this.hn.fetchComment(S))))),this.linkIframeVisible=new a.X(!1)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(y.c),t.Y36(f.H7),t.Y36(f.Dx))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-story-view"]],inputs:{storyId:"storyId"},standalone:!0,features:[t.jDz],decls:5,vars:6,consts:[[1,"container","mx-auto"],[4,"ngIf"],["class","flex flex-col space-y-4",4,"ngIf"],[1,"text-lg"],[1,"text-sm","text-gray-600"],[1,"hover:underline","underline-offset-2","decoration-orange-600",3,"routerLink"],[1,"flex","flex-row","my-2","space-x-5"],[1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"click"],["target","_blank",1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"href"],["class","h-[80vh] mx-auto w-[100%]","frameborder","0",3,"src",4,"ngIf"],["frameborder","0",1,"h-[80vh]","mx-auto","w-[100%]",3,"src"],[1,"flex","flex-col","space-y-4"],["class","block",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block",3,"comment","hierarchyLevel"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0),t.YNc(1,k,15,13,"ng-container",1),t.ALo(2,"async"),t.YNc(3,V,2,1,"section",2),t.ALo(4,"async"),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,o.story$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(4,4,o.comments$)))},dependencies:[s.ez,s.sg,s.O5,s.Ov,s.uU,l.Bz,l.rH,I],changeDetection:0}),e})()}}]);