"use strict";(self.webpackChunkhackernews=self.webpackChunkhackernews||[]).push([[553],{6553:(U,h,c)=>{c.r(h),c.d(h,{StoryViewComponent:()=>Q});var r=c(5093),u=c(4599),p=c(4318),g=c(808),d=c(8730),a=c(7292),x=c(4273),l=c(2523),C=c(6486),e=c(2509),f=c(3779),y=c(6038);function _(t,i){if(1&t&&e._UZ(0,"p",7),2&t){const n=e.oxw().ngIf,o=e.oxw();e.Q6J("innerHTML",o.sanitizer.bypassSecurityTrustHtml(n.text),e.oJD)}}function v(t,i){if(1&t&&e._UZ(0,"app-comment",11),2&t){const n=i.$implicit,o=e.oxw(4);e.Udp("margin-left",1*(o.hierarchyLevel+1),"rem"),e.Q6J("comment",n)("hierarchyLevel",o.hierarchyLevel+1)}}function b(t,i){if(1&t&&(e.TgZ(0,"section",9),e.YNc(1,v,1,4,"app-comment",10),e.qZA()),2&t){const n=i.ngIf;e.xp6(1),e.Q6J("ngForOf",n)}}function L(t,i){if(1&t&&(e.ynx(0),e.YNc(1,b,2,1,"section",8),e.ALo(2,"async"),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,n.subComments$))}}function Z(t,i){1&t&&(e.TgZ(0,"section")(1,"p",12),e._uU(2,"Loading subcomments..."),e.qZA()())}const w=function(t){return["/user",t]};function T(t,i){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"section",1)(2,"div",2),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.toggleCommentVisibility.next(!s.toggleCommentVisibility.value))}),e.qZA(),e.TgZ(3,"div",3)(4,"p",4)(5,"a",5),e._uU(6),e.qZA(),e._uU(7),e.ALo(8,"date"),e.qZA(),e.YNc(9,_,1,1,"p",6),e.ALo(10,"async"),e.qZA()(),e.YNc(11,L,3,3,"ng-container",0),e.ALo(12,"async"),e.YNc(13,Z,3,0,"section",0),e.ALo(14,"async"),e.BQk()}if(2&t){const n=i.ngIf,o=e.oxw();e.xp6(5),e.Q6J("routerLink",e.VKq(15,w,n.by)),e.xp6(1),e.hij(" ",n.by,""),e.xp6(1),e.hij(" at ",e.xi3(8,6,1e3*n.time,"medium")," "),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(10,9,o.toggleCommentVisibility)),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(12,11,o.toggleCommentVisibility)),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(14,13,o.subCommentLoading$))}}let I=(()=>{class t{set comment(n){this.comment$.next(n)}constructor(n,o){this.sanitizer=n,this.hn=o,this.hierarchyLevel=0,this.subCommentLoading$=new a.X(!1),this.comment$=new u.t,this.subComments$=this.comment$.pipe((0,C.h)(s=>!!s&&!!s.kids&&s.kids.length>0),(0,g.b)(()=>{this.subCommentLoading$.next(!0)}),(0,p.b)(s=>(0,x.D)(s.kids.map(m=>this.hn.fetchComment(m)))),(0,g.b)(()=>{this.subCommentLoading$.next(!1)})),this.toggleCommentVisibility=new a.X(!0)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.H7),e.Y36(y.c))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-comment"]],inputs:{comment:"comment",hierarchyLevel:"hierarchyLevel"},standalone:!0,features:[e.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"flex","flex-row","space-x-1"],[1,"w-2","bg-orange-300","cursor-pointer","hover:bg-orange-400",3,"click"],[1,"flex-1"],[1,"text-sm","text-gray-400"],[1,"hover:underline","underline-offset-2","decoration-orange-600","hover:text-gray-600",3,"routerLink"],["class","w-auto ml-2 prose-sm prose prose-gray max-w-none",3,"innerHTML",4,"ngIf"],[1,"w-auto","ml-2","prose-sm","prose","prose-gray","max-w-none",3,"innerHTML"],["class","flex flex-col space-y-4",4,"ngIf"],[1,"flex","flex-col","space-y-4"],["class","block mt-2",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block","mt-2",3,"comment","hierarchyLevel"],[1,"text-gray-600"]],template:function(n,o){1&n&&(e.YNc(0,T,15,17,"ng-container",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,o.comment$))},dependencies:[t,r.ez,r.sg,r.O5,r.Ov,r.uU,l.Bz,l.rH],changeDetection:0}),t})();function A(t,i){if(1&t&&e._UZ(0,"iframe",10),2&t){const n=e.oxw().ngIf,o=e.oxw();e.Q6J("src",o.sanitizer.bypassSecurityTrustResourceUrl(n.url),e.uOi)}}const $=function(t){return["/user",t]};function k(t,i){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"h1",3),e._uU(2),e.qZA(),e.TgZ(3,"p",4),e._uU(4),e.ALo(5,"date"),e.TgZ(6,"a",5),e._uU(7),e.qZA()(),e.TgZ(8,"section",6)(9,"button",7),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.linkIframeVisible.next(!s.linkIframeVisible.value))}),e._uU(10," Open story with comments "),e.qZA(),e.TgZ(11,"a",8),e._uU(12," Open story in new tab "),e.qZA()(),e.YNc(13,A,1,1,"iframe",9),e.ALo(14,"async"),e.BQk()}if(2&t){const n=i.ngIf,o=e.oxw();e.xp6(2),e.Oqu(n.title),e.xp6(2),e.hij(" ",e.xi3(5,6,1e3*n.time,"medium")," by "),e.xp6(2),e.Q6J("routerLink",e.VKq(11,$,n.by)),e.xp6(1),e.hij(" ",n.by,""),e.xp6(4),e.Q6J("href",n.url,e.LSH),e.xp6(2),e.Q6J("ngIf",!0===e.lcZ(14,9,o.linkIframeVisible))}}function J(t,i){if(1&t&&e._UZ(0,"app-comment",13),2&t){const n=i.$implicit;e.Udp("margin-left",1,"rem"),e.Q6J("comment",n)("hierarchyLevel",1)}}function V(t,i){if(1&t&&(e.TgZ(0,"section",11),e.YNc(1,J,1,4,"app-comment",12),e.qZA()),2&t){const n=i.ngIf;e.xp6(1),e.Q6J("ngForOf",n)}}let Q=(()=>{class t{set storyId(n){this.storyIdChanged$.next(n)}constructor(n,o,s){this.hn=n,this.sanitizer=o,this.title=s,this.storyIdChanged$=new u.t,this.story$=this.storyIdChanged$.pipe((0,p.b)(m=>this.hn.fetchStory(m)),(0,g.b)(m=>{this.title.setTitle(`Story: ${m.title}`)}),(0,d.d)()),this.commentsLoading$=new a.X(!1),this.comments$=this.story$.pipe((0,p.b)(m=>(0,x.D)(m.kids.map(S=>this.hn.fetchComment(S))))),this.linkIframeVisible=new a.X(!1)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(y.c),e.Y36(f.H7),e.Y36(f.Dx))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-story-view"]],inputs:{storyId:"storyId"},standalone:!0,features:[e.jDz],decls:5,vars:6,consts:[[1,""],[4,"ngIf"],["class","flex flex-col space-y-4",4,"ngIf"],[1,"text-lg"],[1,"text-sm","text-gray-600"],[1,"hover:underline","underline-offset-2","decoration-orange-600",3,"routerLink"],[1,"flex","flex-row","my-2","space-x-5"],[1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"click"],["target","_blank",1,"px-2","py-1","text-sm","transition-colors","bg-orange-600","rounded-md","hover:bg-orange-700","text-orange-50",3,"href"],["class","h-[80vh] mx-auto w-[100%]","frameborder","0",3,"src",4,"ngIf"],["frameborder","0",1,"h-[80vh]","mx-auto","w-[100%]",3,"src"],[1,"flex","flex-col","space-y-4"],["class","block",3,"margin-left","comment","hierarchyLevel",4,"ngFor","ngForOf"],[1,"block",3,"comment","hierarchyLevel"]],template:function(n,o){1&n&&(e.TgZ(0,"section",0),e.YNc(1,k,15,13,"ng-container",1),e.ALo(2,"async"),e.YNc(3,V,2,1,"section",2),e.ALo(4,"async"),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,o.story$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,4,o.comments$)))},dependencies:[r.ez,r.sg,r.O5,r.Ov,r.uU,l.Bz,l.rH,I],changeDetection:0}),t})()}}]);