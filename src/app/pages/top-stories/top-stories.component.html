<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->
<p class="text-xl">
  {{ pageTitle$ | async }}
  <span *ngIf="this.storiesCount$ | async as count" class="text-gray-600"
    >({{ count === 0 ? "loading..." : count }})</span
  >
</p>
<p class="text-gray-700" *ngIf="(this.storiesLoading | async) === true">
  Loading stories...
</p>
<p class="text-gray-700" *ngIf="(this.storiesContentLoading | async) === true">
  Loading stories info...
</p>

<section class="flex flex-col" *ngIf="this.stories$ | async as stories">
  <div class="mx-2 my-2" *ngFor="let story of stories">
    <!-- Link to external url if exists -->
    <a
      *ngIf="story.url"
      class="text-lg font-semibold transition-colors hover:text-orange-600"
      [href]="story.url"
    >
      {{ story.title }}
      <span class="text-xs text-gray-500">{{ story.url | urlPreview }}</span>
    </a>
    <!-- Link to comments if no external url -->
    <a
      *ngIf="!story.url"
      class="text-lg font-semibold transition-colors hover:text-orange-600"
      [routerLink]="['/stories', story.id]"
    >
      {{ story.title }}
    </a>
    <div class="text-sm text-gray-600">
      <p class="">
        {{ story.score }} point posted at
        {{ story.time * 1000 | date : "medium" }} by
        <a
          class="hover:underline underline-offset-2 decoration-orange-600"
          [routerLink]="['/user', story.by]"
          >{{ story.by }}</a
        >
      </p>
      <div>
        <a
          [routerLink]="['/stories', story.id]"
          class="hover:underline underline-offset-2 decoration-orange-600"
        >
          {{ story.descendants }} comments.
        </a>
        <span
          *ngIf="story.saved === true"
          (click)="this.savedStories.unSaveStory(story)"
          class="cursor-pointer hover:underline underline-offset-2 decoration-orange-600"
        >
          Unsave story.
        </span>
        <span
          *ngIf="story.saved === false"
          (click)="this.savedStories.saveStory(story)"
          class="cursor-pointer hover:underline underline-offset-2 decoration-orange-600"
        >
          Save story.
        </span>
      </div>
    </div>
  </div>
</section>
