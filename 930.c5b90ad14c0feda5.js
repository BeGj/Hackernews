"use strict";(self.webpackChunkhackernews=self.webpackChunkhackernews||[]).push([[930],{5930:(w,d,n)=>{n.r(d),n.d(d,{TopStoriesComponent:()=>N});var c=n(5093),v=n(4599),l=n(7292),u=n(808),x=n(4318),T=n(6173),m=n(812),S=n(8366),L=n(3756),Z=n(2799),C=n(909),I=n(4273),U=n(1676),y=n(2523),t=n(2509);let $=(()=>{class e{transform(o,...r){return new URL(o).hostname}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275pipe=t.Yjl({name:"urlPreview",type:e,pure:!0,standalone:!0}),e})();var j=n(6038);function J(e,s){if(1&e&&(t.TgZ(0,"span",4),t._uU(1),t.qZA()),2&e){const o=s.ngIf;t.xp6(1),t.hij("(",0===o?"loading...":o,")")}}function O(e,s){1&e&&(t.TgZ(0,"p",5),t._uU(1," Loading...\n"),t.qZA())}function P(e,s){1&e&&(t.TgZ(0,"p",5),t._uU(1," Loading content...\n"),t.qZA())}const Q=function(e){return["/user",e]},F=function(e){return["/stories",e]};function X(e,s){if(1&e&&(t.TgZ(0,"div",8)(1,"a",9),t._uU(2),t.TgZ(3,"span",10),t._uU(4),t.ALo(5,"urlPreview"),t.qZA()(),t.TgZ(6,"div",11)(7,"p",12),t._uU(8),t.ALo(9,"date"),t.TgZ(10,"a",13),t._uU(11),t.qZA()(),t.TgZ(12,"a",13),t._uU(13),t.qZA()()()),2&e){const o=s.$implicit;t.xp6(1),t.Q6J("href",o.url,t.LSH),t.xp6(1),t.hij(" ",o.title," "),t.xp6(2),t.Oqu(t.lcZ(5,9,o.url)),t.xp6(4),t.AsE(" ",o.score," point posted at ",t.xi3(9,11,1e3*o.time,"medium")," by "),t.xp6(2),t.Q6J("routerLink",t.VKq(14,Q,o.by)),t.xp6(1),t.Oqu(o.by),t.xp6(1),t.Q6J("routerLink",t.VKq(16,F,o.id)),t.xp6(1),t.hij(" ",o.descendants," comments ")}}function Y(e,s){if(1&e&&(t.TgZ(0,"section",6),t.YNc(1,X,14,18,"div",7),t.qZA()),2&e){const o=s.ngIf;t.xp6(1),t.Q6J("ngForOf",o)}}let N=(()=>{class e{constructor(o){this.hn=o,this.triggerTopStoriesLoad$=new v.t,this.firstStoryIndex$=new l.X(0),this.lastStoryIndex$=new l.X(50),this.storiesCount$=new l.X(0),this.storiesLoading=new l.X(!0),this.storiesContentLoading=new l.X(!1),this.fetchTopStoryIds$=this.hn.fetchTopStories().pipe((0,u.b)(r=>{this.storiesLoading.next(!1),this.storiesCount$.next(r.length)})),this.topStories$=this.triggerTopStoriesLoad$.pipe((0,x.b)(()=>this.fetchTopStoryIds$),(0,u.b)(()=>{this.storiesContentLoading.next(!0)}),function A(...e){const s=(0,C.jO)(e);return(0,T.e)((o,r)=>{const a=e.length,f=new Array(a);let p=e.map(()=>!1),h=!1;for(let i=0;i<a;i++)(0,S.Xf)(e[i]).subscribe((0,m.x)(r,g=>{f[i]=g,!h&&!p[i]&&(p[i]=!0,(h=p.every(L.y))&&(p=null))},Z.Z));o.subscribe((0,m.x)(r,i=>{if(h){const g=[i,...f];r.next(s?s(...g):g)}}))})}(this.firstStoryIndex$,this.lastStoryIndex$),(0,x.b)(([r,a,f])=>(0,I.D)(r.slice(a,f).map(p=>this.hn.fetchStory(p)))),(0,U.U)(r=>r.filter(a=>["story","ask"].includes(a.type))),(0,u.b)(()=>{this.storiesLoading.next(!1),this.storiesContentLoading.next(!1)})),this.triggerTopStoriesLoad$.next(!0)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(j.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-top-stories"]],standalone:!0,features:[t.jDz],decls:10,vars:12,consts:[[1,"text-xl"],["class","text-gray-600",4,"ngIf"],["class","text-gray-700",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"text-gray-600"],[1,"text-gray-700"],[1,"flex","flex-col"],["class","mx-2 my-2",4,"ngFor","ngForOf"],[1,"mx-2","my-2"],[1,"text-lg","font-semibold","transition-colors","hover:text-orange-600",3,"href"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-600"],[1,""],[1,"hover:underline","underline-offset-2","decoration-orange-600",3,"routerLink"]],template:function(o,r){1&o&&(t.TgZ(0,"p",0),t._uU(1," Top stories "),t.YNc(2,J,2,1,"span",1),t.ALo(3,"async"),t.qZA(),t.YNc(4,O,2,0,"p",2),t.ALo(5,"async"),t.YNc(6,P,2,0,"p",2),t.ALo(7,"async"),t.YNc(8,Y,2,1,"section",3),t.ALo(9,"async")),2&o&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,r.storiesCount$)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(5,6,r.storiesLoading)),t.xp6(2),t.Q6J("ngIf",!0===t.lcZ(7,8,r.storiesContentLoading)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,10,r.topStories$)))},dependencies:[c.ez,c.sg,c.O5,c.Ov,c.uU,y.Bz,y.rH,$],changeDetection:0}),e})()}}]);